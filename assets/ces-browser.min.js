var CES=function(){var t=function(e,n){var i=t.resolve(e,n||"/"),r=t.modules[i];if(!r)throw new Error("Failed to resolve module "+e+", tried "+i);var s=t.cache[i],o=s?s.exports:r();return o};return t.paths=[],t.modules={},t.cache={},t.extensions=[".js",".coffee",".json"],t._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},t.resolve=function(){return function(e,n){function i(e){if(e=a.normalize(e),t.modules[e])return e;for(var n=0;n<t.extensions.length;n++){var i=t.extensions[n];if(t.modules[e+i])return e+i}}function r(e){e=e.replace(/\/+$/,"");var n=a.normalize(e+"/package.json");if(t.modules[n]){var r=t.modules[n](),s=r.browserify;if("object"==typeof s&&s.main){var o=i(a.resolve(e,s.main));if(o)return o}else if("string"==typeof s){var o=i(a.resolve(e,s));if(o)return o}else if(r.main){var o=i(a.resolve(e,r.main));if(o)return o}}return i(e+"/index")}function s(t,e){for(var n=o(e),s=0;s<n.length;s++){var a=n[s],u=i(a+"/"+t);if(u)return u;var d=r(a+"/"+t);if(d)return d}var u=i(t);return u?u:void 0}function o(t){var e;e="/"===t?[""]:a.normalize(t).split("/");for(var n=[],i=e.length-1;i>=0;i--)if("node_modules"!==e[i]){var r=e.slice(0,i+1).join("/")+"/node_modules";n.push(r)}return n}if(n||(n="/"),t._core[e])return e;var a=t.modules.path();n=a.resolve("/",n);var u=n||"/";if(e.match(/^(?:\.\.?\/|\/)/)){var d=i(a.resolve(u,e))||r(a.resolve(u,e));if(d)return d}var l=s(e,u);if(l)return l;throw new Error("Cannot find module '"+e+"'")}}(),t.alias=function(e,n){var i=t.modules.path(),r=null;try{r=t.resolve(e+"/package.json","/")}catch(s){r=t.resolve(e,"/")}for(var o=i.dirname(r),a=(Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e})(t.modules),u=0;u<a.length;u++){var d=a[u];if(d.slice(0,o.length+1)===o+"/"){var l=d.slice(o.length);t.modules[n+l]=t.modules[o+l]}else d===o&&(t.modules[n]=t.modules[o])}},function(){var e={},n="undefined"!=typeof window?window:{},i=!1;t.define=function(r,s){!i&&t.modules.__browserify_process&&(e=t.modules.__browserify_process(),i=!0);var o=t._core[r]?"":t.modules.path().dirname(r),a=function(e){var n=t(e,o),i=t.cache[t.resolve(e,o)];return i&&null===i.parent&&(i.parent=u),n};a.resolve=function(e){return t.resolve(e,o)},a.modules=t.modules,a.define=t.define,a.cache=t.cache;var u={id:r,filename:r,exports:{},loaded:!1,parent:null};t.modules[r]=function(){return t.cache[r]=u,s.call(u.exports,a,u,u.exports,o,r,e,n),u.loaded=!0,u.exports}}}(),t.define("path",function(t,e,n,i,r,s){function o(t,e){for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}function a(t,e){for(var n=0,i=t.length;i>=0;i--){var r=t[i];"."==r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){for(var t="",e=!1,n=arguments.length;n>=-1&&!e;n--){var i=n>=0?arguments[n]:s.cwd();"string"==typeof i&&i&&(t=i+"/"+t,e="/"===i.charAt(0))}return t=a(o(t.split("/"),function(t){return!!t}),!e).join("/"),(e?"/":"")+t||"."},n.normalize=function(t){var e="/"===t.charAt(0),n="/"===t.slice(-1);return t=a(o(t.split("/"),function(t){return!!t}),!e).join("/"),t||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(o(t,function(t){return t&&"string"==typeof t}).join("/"))},n.dirname=function(t){var e=u.exec(t)[1]||"",n=!1;return e?1===e.length||n&&e.length<=3&&":"===e.charAt(1)?e:e.substring(0,e.length-1):"."},n.basename=function(t,e){var n=u.exec(t)[2]||"";return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return u.exec(t)[3]||""},n.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var r=i(t.split("/")),s=i(e.split("/")),o=Math.min(r.length,s.length),a=o,u=0;o>u;u++)if(r[u]!==s[u]){a=u;break}for(var d=[],u=a;u<r.length;u++)d.push("..");return d=d.concat(s.slice(a)),d.join("/")}}),t.define("__browserify_process",function(t,e,n,i,r,s){var s=e.exports={};s.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){if(t.source===window&&"browserify-tick"===t.data&&(t.stopPropagation(),n.length>0)){var e=n.shift();e()}},!0),function(t){n.push(t),window.postMessage("browserify-tick","*")}}return function(t){setTimeout(t,0)}}(),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.binding=function(e){if("evals"===e)return t("vm");throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,n="/";s.cwd=function(){return n},s.chdir=function(i){e||(e=t("path")),n=e.resolve(i,n)}}()}),t.define("/src/class.js",function(t,e){var n=!1,i=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,r=e.exports=function(){};r.extend=function(t){function e(){!n&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;n=!0;var s=new this;n=!1;for(var o in t)s[o]="function"==typeof t[o]&&"function"==typeof r[o]&&i.test(t[o])?function(t,e){return function(){var n=this._super;this._super=r[t];var i=e.apply(this,arguments);return this._super=n,i}}(o,t[o]):t[o];return e.prototype=s,e.prototype.constructor=e,e.extend=arguments.callee,e}}),t.define("/src/component.js",function(t,e){{var n=t("./class");e.exports=n.extend({name:""})}}),t.define("/src/entity.js",function(t,e){var n=t("./class"),i=t("./signal"),r=e.exports=n.extend({init:function(){this.id=r._id++,this._components={},this.onComponentAdded=new i,this.onComponentRemoved=new i},hasComponent:function(t){return void 0!==this._components["$"+t]},getComponent:function(t){return this._components["$"+t]},addComponent:function(t){this._components["$"+t.name]=t,this.onComponentAdded.emit(this,t.name)},removeComponent:function(t){var e=this._components["$"+t];this._components["$"+t]=void 0,this.onComponentRemoved.emit(this,t,e)}});r._id=0}),t.define("/src/signal.js",function(t,e){{var n=t("./class");e.exports=n.extend({init:function(){this._listeners=[]},add:function(t){this._listeners.push(t)},remove:function(t){var e,n,i=this._listeners;for(e=0,n=i.length;n>e;++e)if(i[e]===t)return i.splice(e,1),!0;return!1},emit:function(){var t,e,n=arguments,i=this._listeners;for(t=0,e=i.length;e>t;++t)i[t].apply(null,n)}})}}),t.define("/src/system.js",function(t,e){{var n=t("./class");e.exports=n.extend({init:function(){this.world=null},addedToWorld:function(t){this.world=t},removedFromWorld:function(){this.world=null},update:function(){throw new Error("Subclassed should override this method")}})}}),t.define("/src/world.js",function(t,e){{var n=t("./class"),i=t("./family"),r=t("./entitylist");e.exports=n.extend({init:function(){this._families={},this._systems=[],this._entities=new r},addSystem:function(t){return this._systems.push(t),t.addedToWorld(this),this},removeSystem:function(t){var e,n,i;for(e=this._systems,n=0,i=e.length;i>n;++n)e[n]===t&&(e.splice(n,1),t.removedFromWorld())},addEntity:function(t){var e,n,i;e=this._families;for(n in e)e[n].addEntityIfMatch(t);i=this,t.onComponentAdded.add(function(t,e,n){i._onComponentAdded(t,e,n)}),t.onComponentRemoved.add(function(t,e,n){i._onComponentRemoved(t,e,n)}),this._entities.add(t)},removeEntity:function(t){var e,n;e=this._families;for(n in e)e[n].removeEntity(t);this._entities.remove(t)},getEntities:function(){var t;return t=this._getFamilyId(arguments),this._ensureFamilyExists(arguments),this._families[t].getEntities()},update:function(t){var e,n,i;for(e=this._systems,n=0,i=e.length;i>n;++n)e[n].update(t)},entityAdded:function(){var t;return t=this._getFamilyId(arguments),this._ensureFamilyExists(arguments),this._families[t].entityAdded},entityRemoved:function(){var t;return t=this._getFamilyId(arguments),this._ensureFamilyExists(arguments),this._families[t].entityRemoved},_ensureFamilyExists:function(t){var e=this._families,n=this._getFamilyId(t);if(!e[n]){e[n]=new i(Array.prototype.slice.call(t));for(var r=this._entities.head;r;r=r.next)e[n].addEntityIfMatch(r.entity)}},_getFamilyId:function(t){return"$"+Array.prototype.join.call(t,",")},_onComponentAdded:function(t,e){var n,i;n=this._families;for(i in n)n[i].onComponentAdded(t,e)},_onComponentRemoved:function(t,e,n){var i,r;i=this._families;for(r in i)i[r].onComponentRemoved(t,e,n)}})}}),t.define("/src/family.js",function(t,e){{var n=t("./class"),i=t("./entitylist"),r=t("./signal");e.exports=n.extend({init:function(t){this._componentNames=t,this._entities=new i,this.entityAdded=new r,this.entityRemoved=new r},getEntities:function(){return this._entities.toArray()},addEntityIfMatch:function(t){!this._entities.has(t)&&this._matchEntity(t)&&(this._entities.add(t),this.entityAdded.emit(t))},removeEntity:function(t){this._entities.has(t)&&(this._entities.remove(t),this.entityRemoved.emit(t))},onComponentAdded:function(t){this.addEntityIfMatch(t)},onComponentRemoved:function(t,e,n){var i,r,s;if(this._entities.has(t))for(i=this._componentNames,r=0,s=i.length;s>r;++r)i[r]===e&&(this._entities.remove(t),this.entityRemoved.emit(t,n))},_matchEntity:function(t){var e,n,i;for(e=this._componentNames,n=0,i=e.length;i>n;++n)if(!t.hasComponent(e[n]))return!1;return!0}})}}),t.define("/src/entitylist.js",function(t,e){{var n=t("./class"),i=n.extend({init:function(t){this.entity=t,this.prev=null,this.next=null}});e.exports=n.extend({init:function(){this.head=null,this.tail=null,this.length=0,this._entities={}},add:function(t){var e=new i(t);null===this.head?this.head=this.tail=e:(e.prev=this.tail,this.tail.next=e,this.tail=e),this.length+=1,this._entities[t.id]=e},remove:function(t){var e=this._entities[t.id];void 0!==e&&(null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this.length-=1,delete this._entities[t.id])},has:function(t){return void 0!==this._entities[t.id]},clear:function(){this.head=this.tail=null,this.length=0,this._entities={}},toArray:function(){var t,e;for(t=[],e=this.head;e;e=e.next)t.push(e.entity);return t}})}}),t.define("/index.js",function(t,e){e.exports={Class:t("./src/class"),Component:t("./src/component"),Entity:t("./src/entity"),System:t("./src/system"),World:t("./src/world")}}),t("/index.js"),t("/index.js")}();
