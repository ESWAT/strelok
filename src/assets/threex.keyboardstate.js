var THREEx=THREEx||{};THREEx.KeyboardState=function(a){this.domElement=a||document,this.keyCodes={},this.modifiers={};var b=this;this._onKeyDown=function(a){b._onKeyChange(a)},this._onKeyUp=function(a){b._onKeyChange(a)},this.domElement.addEventListener("keydown",this._onKeyDown,!1),this.domElement.addEventListener("keyup",this._onKeyUp,!1),this._onBlur=function(){for(var a in b.keyCodes)b.keyCodes[a]=!1;for(var a in b.modifiers)b.modifiers[a]=!1},window.addEventListener("blur",this._onBlur,!1)},THREEx.KeyboardState.prototype.destroy=function(){this.domElement.removeEventListener("keydown",this._onKeyDown,!1),this.domElement.removeEventListener("keyup",this._onKeyUp,!1),window.removeEventListener("blur",this._onBlur,!1)},THREEx.KeyboardState.MODIFIERS=["shift","ctrl","alt","meta"],THREEx.KeyboardState.ALIAS={left:37,up:38,right:39,down:40,space:32,pageup:33,pagedown:34,tab:9,escape:27},THREEx.KeyboardState.prototype._onKeyChange=function(a){var b=a.keyCode,c="keydown"===a.type?!0:!1;this.keyCodes[b]=c,this.modifiers.shift=a.shiftKey,this.modifiers.ctrl=a.ctrlKey,this.modifiers.alt=a.altKey,this.modifiers.meta=a.metaKey},THREEx.KeyboardState.prototype.pressed=function(a){for(var b=a.split("+"),c=0;c<b.length;c++){var d=b[c],e=!1;if(e=-1!==THREEx.KeyboardState.MODIFIERS.indexOf(d)?this.modifiers[d]:-1!=Object.keys(THREEx.KeyboardState.ALIAS).indexOf(d)?this.keyCodes[THREEx.KeyboardState.ALIAS[d]]:this.keyCodes[d.toUpperCase().charCodeAt(0)],!e)return!1}return!0},THREEx.KeyboardState.prototype.eventMatches=function(a,b){for(var c=THREEx.KeyboardState.ALIAS,d=Object.keys(c),e=b.split("+"),f=0;f<e.length;f++){var g=e[f],h=!1;if("shift"===g?h=a.shiftKey?!0:!1:"ctrl"===g?h=a.ctrlKey?!0:!1:"alt"===g?h=a.altKey?!0:!1:"meta"===g?h=a.metaKey?!0:!1:-1!==d.indexOf(g)?h=a.keyCode===c[g]?!0:!1:a.keyCode===g.toUpperCase().charCodeAt(0)&&(h=!0),!h)return!1}return!0};
